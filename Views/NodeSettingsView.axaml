<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="using:Retromind.ViewModels"
        xmlns:models="using:Retromind.Models"
        xmlns:p="clr-namespace:Retromind.Resources"
        mc:Ignorable="d" d:DesignWidth="500" d:DesignHeight="600"
        x:Class="Retromind.Views.NodeSettingsView"
        x:DataType="vm:NodeSettingsViewModel"
        Title="{x:Static p:Strings.NodeSettings_Title}"
        Width="550" SizeToContent="Height"
        WindowStartupLocation="CenterOwner"
        CanResize="False">

    <Border Padding="20">
        <StackPanel Spacing="20">

            <!-- NAME & DESCRIPTION -->
            <StackPanel Spacing="10">
                <StackPanel Spacing="5">
                    <TextBlock Text="{x:Static p:Strings.Common_Name}"/>
                    <TextBox Text="{Binding Name}"/>
                </StackPanel>

                <StackPanel Spacing="5">
                    <TextBlock Text="{x:Static p:Strings.NodeSettings_DescriptionForBigMode}"/>
                    <TextBox Text="{Binding Description}" AcceptsReturn="True" Height="60" TextWrapping="Wrap"/>
                </StackPanel>
            </StackPanel>

            <!-- EMULATOR -->
            <StackPanel Spacing="5">
                <TextBlock Text="{x:Static p:Strings.NodeSettings_DefaultEmulatorForFolder}"/>
                <ComboBox ItemsSource="{Binding AvailableEmulators}"
                          SelectedItem="{Binding SelectedEmulator}"
                          HorizontalAlignment="Stretch">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Name}"/>
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
            </StackPanel>

            <!-- BIGMODE THEME -->
            <StackPanel Spacing="5">
                <TextBlock Text="{x:Static p:Strings.NodeSettings_BigModeThemeHint}"/>
                <ComboBox ItemsSource="{Binding AvailableThemes}"
                          SelectedItem="{Binding SelectedTheme}"
                          HorizontalAlignment="Stretch"/>

                <Button Content="{x:Static p:Strings.NodeSettings_ThemeAuto}"
                        HorizontalAlignment="Left"
                        Command="{Binding ClearThemeCommand}"
                        IsVisible="{Binding IsThemeExplicitlySelected}"/>
            </StackPanel>

            <!-- ASSETS (collapsed by default) -->
            <Expander Header="{x:Static p:Strings.NodeSettings_PresentationAndAssets}"
                      IsExpanded="False"
                      HorizontalAlignment="Stretch">
                <StackPanel Spacing="15">

                    <!-- 1. COVER -->
                    <Grid ColumnDefinitions="80, *, Auto">
                        <Border Grid.Column="0" Width="60" Height="80" Background="#22000000" CornerRadius="4" ClipToBounds="True">
                            <Panel>
                                <PathIcon Data="M8.5,13.5L11,16.5L14.5,12L19,18H5M21,19V5C21,3.89 20.1,3 19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19Z"
                                          Opacity="0.3"
                                          IsVisible="{Binding CoverPreview, Converter={x:Static ObjectConverters.IsNull}}"/>
                                <Image Source="{Binding CoverPreview}" Stretch="UniformToFill"/>
                            </Panel>
                        </Border>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="15,0">
                            <TextBlock Text="{x:Static p:Strings.NodeSettings_CoverBoxart}" FontWeight="Bold"/>
                            <TextBlock Text="{x:Static p:Strings.NodeSettings_CoverBoxartHint}" FontSize="11" Opacity="0.6"/>
                        </StackPanel>
                        <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="5">
                            <Button Command="{Binding ImportAssetCommand}" CommandParameter="{x:Static models:AssetType.Cover}" ToolTip.Tip="{x:Static p:Strings.Common_SelectFile}">
                                <PathIcon Data="M19,20H5V8H19M10,2H5A2,2 0 0,0 3,4V20A2,2 0 0,0 5,22H19A2,2 0 0,0 21,20V6A2,2 0 0,0 19,4H12L10,2Z"/>
                            </Button>
                            <Button Command="{Binding DeleteAssetCommand}" CommandParameter="{x:Static models:AssetType.Cover}"
                                    IsEnabled="{Binding CoverPreview, Converter={x:Static ObjectConverters.IsNotNull}}"
                                    ToolTip.Tip="{x:Static p:Strings.Common_Delete}">
                                <PathIcon Data="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" Foreground="Red"/>
                            </Button>
                        </StackPanel>
                    </Grid>

                    <Separator Opacity="0.1"/>

                    <!-- 2. LOGO -->
                    <Grid ColumnDefinitions="80, *, Auto">
                        <Border Grid.Column="0" Width="80" Height="40" Background="#22000000" CornerRadius="4" ClipToBounds="True">
                            <Panel>
                                <PathIcon Data="M8.5,13.5L11,16.5L14.5,12L19,18H5M21,19V5C21,3.89 20.1,3 19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19Z"
                                          Opacity="0.3"
                                          IsVisible="{Binding LogoPreview, Converter={x:Static ObjectConverters.IsNull}}"/>
                                <Image Source="{Binding LogoPreview}" Stretch="Uniform"/>
                            </Panel>
                        </Border>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="15,0">
                            <TextBlock Text="{x:Static p:Strings.NodeSettings_LogoClearart}" FontWeight="Bold"/>
                            <TextBlock Text="{x:Static p:Strings.NodeSettings_LogoClearartHint}" FontSize="11" Opacity="0.6"/>
                        </StackPanel>
                        <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="5">
                            <Button Command="{Binding ImportAssetCommand}" CommandParameter="{x:Static models:AssetType.Logo}" ToolTip.Tip="{x:Static p:Strings.Common_SelectFile}">
                                <PathIcon Data="M19,20H5V8H19M10,2H5A2,2 0 0,0 3,4V20A2,2 0 0,0 5,22H19A2,2 0 0,0 21,20V6A2,2 0 0,0 19,4H12L10,2Z"/>
                            </Button>
                            <Button Command="{Binding DeleteAssetCommand}" CommandParameter="{x:Static models:AssetType.Logo}"
                                    IsEnabled="{Binding LogoPreview, Converter={x:Static ObjectConverters.IsNotNull}}"
                                    ToolTip.Tip="{x:Static p:Strings.Common_Delete}">
                                <PathIcon Data="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" Foreground="Red"/>
                            </Button>
                        </StackPanel>
                    </Grid>

                    <Separator Opacity="0.1"/>

                    <!-- 3. WALLPAPER -->
                    <Grid ColumnDefinitions="80, *, Auto">
                        <Border Grid.Column="0" Width="80" Height="45" Background="#22000000" CornerRadius="4" ClipToBounds="True">
                            <Panel>
                                <PathIcon Data="M8.5,13.5L11,16.5L14.5,12L19,18H5M21,19V5C21,3.89 20.1,3 19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19Z"
                                          Opacity="0.3"
                                          IsVisible="{Binding WallpaperPreview, Converter={x:Static ObjectConverters.IsNull}}"/>
                                <Image Source="{Binding WallpaperPreview}" Stretch="UniformToFill"/>
                            </Panel>
                        </Border>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="15,0">
                            <TextBlock Text="{x:Static p:Strings.NodeSettings_Background}" FontWeight="Bold"/>
                            <TextBlock Text="{x:Static p:Strings.NodeSettings_BackgroundHint}" FontSize="11" Opacity="0.6"/>
                        </StackPanel>
                        <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="5">
                            <Button Command="{Binding ImportAssetCommand}" CommandParameter="{x:Static models:AssetType.Wallpaper}" ToolTip.Tip="{x:Static p:Strings.Common_SelectFile}">
                                <PathIcon Data="M19,20H5V8H19M10,2H5A2,2 0 0,0 3,4V20A2,2 0 0,0 5,22H19A2,2 0 0,0 21,20V6A2,2 0 0,0 19,4H12L10,2Z"/>
                            </Button>
                            <Button Command="{Binding DeleteAssetCommand}" CommandParameter="{x:Static models:AssetType.Wallpaper}"
                                    IsEnabled="{Binding WallpaperPreview, Converter={x:Static ObjectConverters.IsNotNull}}"
                                    ToolTip.Tip="{x:Static p:Strings.Common_Delete}">
                                <PathIcon Data="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" Foreground="Red"/>
                            </Button>
                        </StackPanel>
                    </Grid>

                    <Separator Opacity="0.1"/>

                    <!-- 4. VIDEO -->
                    <Grid ColumnDefinitions="80, *, Auto">
                        <Border Grid.Column="0" Width="80" Height="45" Background="#22000000" CornerRadius="4">
                            <PathIcon Data="M17,10.5V7A1,1 0 0,0 16,6H4A1,1 0 0,0 3,7V17A1,1 0 0,0 4,18H16A1,1 0 0,0 17,17V13.5L21,17.5V6.5L17,10.5Z" Opacity="0.5"/>
                        </Border>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="15,0">
                            <TextBlock Text="{x:Static p:Strings.NodeSettings_VideoSnap}" FontWeight="Bold"/>
                            <TextBlock Text="{Binding VideoName}" FontSize="11" Opacity="0.6" TextTrimming="CharacterEllipsis"/>
                        </StackPanel>
                        <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="5">
                            <Button Command="{Binding ImportAssetCommand}" CommandParameter="{x:Static models:AssetType.Video}" ToolTip.Tip="{x:Static p:Strings.Common_SelectFile}">
                                <PathIcon Data="M19,20H5V8H19M10,2H5A2,2 0 0,0 3,4V20A2,2 0 0,0 5,22H19A2,2 0 0,0 21,20V6A2,2 0 0,0 19,4H12L10,2Z"/>
                            </Button>
                            <Button Command="{Binding DeleteAssetCommand}" CommandParameter="{x:Static models:AssetType.Video}"
                                    IsEnabled="{Binding HasVideoAsset}"
                                    ToolTip.Tip="{x:Static p:Strings.Common_Delete}">
                                <PathIcon Data="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" Foreground="Red"/>
                            </Button>
                        </StackPanel>
                    </Grid>

                </StackPanel>
            </Expander>

            <!-- OPTIONS -->
            <StackPanel Spacing="10">
                <CheckBox Content="{x:Static p:Strings.NodeSettings_RandomizeCovers}" IsChecked="{Binding RandomizeCovers}"/>
                <CheckBox Content="{x:Static p:Strings.NodeSettings_RandomizeMusic}" IsChecked="{Binding RandomizeMusic}"/>
            </StackPanel>

            <!-- BUTTONS -->
            <StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Right" Margin="0,10,0,0">
                <Button Content="{x:Static p:Strings.Button_Cancel}" Command="{Binding CancelCommand}"/>
                <Button Content="{x:Static p:Strings.Button_Save}" Classes="accent" Command="{Binding SaveCommand}"/>
            </StackPanel>
        </StackPanel>
    </Border>
</Window>