<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:Retromind.ViewModels"
        xmlns:p="clr-namespace:Retromind.Resources"
        x:Class="Retromind.Views.SearchScopeDialogView"
        x:DataType="vm:SearchScopeDialogViewModel"
        Title="{x:Static p:Strings.Search_ScopesDialogTitle}"
        Width="840" Height="600"
        WindowStartupLocation="CenterOwner">

    <Grid RowDefinitions="Auto, *, Auto" Margin="20">
        <!-- Header -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="8">
            <TextBox Text="{Binding FilterText}"
                     Watermark="{x:Static p:Strings.Search_ScopesFilter}"
                     Width="260"
                     Height="28"
                     VerticalContentAlignment="Center"/>

            <Button Content="{x:Static p:Strings.Search_ScopesSelectAll}"
                    Command="{Binding SelectAllCommand}"
                    Padding="10,4"/>
            <Button Content="{x:Static p:Strings.Search_ScopesSelectNone}"
                    Command="{Binding ClearAllCommand}"
                    Padding="10,4"/>

            <Button Content="{x:Static p:Strings.Search_ScopesExpandAll}"
                    Command="{Binding ExpandAllCommand}"
                    Padding="10,4"/>
            <Button Content="{x:Static p:Strings.Search_ScopesCollapseAll}"
                    Command="{Binding CollapseAllCommand}"
                    Padding="10,4"/>
        </StackPanel>

        <!-- Tree -->
        <Border Grid.Row="1" BorderBrush="Gray" BorderThickness="1" CornerRadius="5" Padding="6">
            <TreeView ItemsSource="{Binding RootNodes}">
                <TreeView.Styles>
                    <Style Selector="TreeViewItem">
                        <Setter x:DataType="vm:SearchScopeNode" Property="IsExpanded"
                                Value="{Binding IsExpanded, Mode=TwoWay}"/>
                        <Setter x:DataType="vm:SearchScopeNode" Property="IsVisible"
                                Value="{Binding IsVisible}"/>
                    </Style>
                </TreeView.Styles>

                <TreeView.ItemTemplate>
                    <TreeDataTemplate x:DataType="vm:SearchScopeNode" ItemsSource="{Binding Children}">
                        <CheckBox IsChecked="{Binding IsChecked, Mode=TwoWay}"
                                  IsThreeState="True"
                                  VerticalAlignment="Center"
                                  ToolTip.Tip="{x:Static p:Strings.Search_ScopesPartialHint}">
                            <TextBlock Text="{Binding DisplayName}"
                                       VerticalAlignment="Center"/>
                        </CheckBox>
                    </TreeDataTemplate>
                </TreeView.ItemTemplate>
            </TreeView>
        </Border>

        <!-- Footer -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Spacing="10" Margin="0,20,0,0">
            <Button Content="{x:Static p:Strings.Button_Cancel}"
                    Command="{Binding CancelCommand}"/>
            <Button Content="{x:Static p:Strings.Button_Apply}"
                    Command="{Binding ApplyCommand}"
                    Classes="accent"/>
        </StackPanel>
    </Grid>
</Window>
